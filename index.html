<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8" />
  <title>Kube Inspector</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="style.css" rel="stylesheet">
  <style>
    html, body {
      height: 100%; margin: 0; font-family: sans-serif; background: #1e1e1e; color: #fff; overflow: hidden;
    }
    #app { display: flex; height: 100vh; overflow: hidden; }

    #sidebar {
      width: 260px; min-width: 160px; max-width: 420px;
      background: #111827; transition: transform 0.1s ease-in-out;
      overflow-y: auto; display: flex; flex-direction: column; z-index: 2;
    }
    #sidebar.collapsed { transform: translateX(-100%); }
    #resizer { width: 6px; cursor: col-resize; background: #222; }
    #resizer:hover { background: #6b6b6b; }

    #mainArea {
      flex: 1; overflow-y: auto; padding: 1rem 1.2rem;
      transition: margin-left .2s ease-in-out; position: relative;
    }

    .namespace { cursor: pointer; font-size: .75rem; }
    .namespace.active { background: #0d6efd; }

    .card { background: #0f172a; color: #fff; font-size: .7rem; position: relative; border-left: 3px solid #0ff; transition: border-left .3s ease-in-out; }
    .card-icons { position: absolute; top: 5px; right: 8px; display: flex; gap: 8px; }
    .card-icons i { cursor: pointer; color: #aaa; }

    .output-box {
      height: 260px; overflow-y: auto; background: #0f172a;
      padding: 10px; border: 1px solid #444; border-radius: .5rem; font-family: monospace;
      position: relative;
    }

    .output-box button.copy-btn {
      position: absolute; top: 8px; right: 12px; font-size: .7rem;
    }

    #toggleBtn {
      position: fixed; top: 10px; right: 10px; z-index: 10;
    }

    .context-menu {
      position: absolute; background: #1f2937; border: 1px solid #4b5563;
      padding: .5rem; border-radius: 5px; z-index: 100; display: none;
    }
    .context-menu button {
      display: block; width: 100%; background: none; border: none;
      color: #fff; text-align: left; padding: 5px; cursor: pointer;
    }
    .context-menu button:hover { background: #374151; }

    .dropdown-menu { max-height: 300px; overflow-y: auto; }
  </style>
</head>
<body>
<div id="app">
  <div id="sidebar" class="p-3">
    <h5>Namespaces</h5>
    <input id="searchBox" type="text" class="form-control mb-2" placeholder="Digita almeno 2 lettere..." />
    <div id="namespaceList" class="list-group small flex-grow-1"></div>
  </div>

  <div id="resizer"></div>

  <div id="mainArea">
    <button id="toggleBtn" class="btn btn-sm btn-outline-light" onclick="toggleSidebar()">‚ò∞</button>
    <h3>Kube Inspector</h3>
    <div id="selectedNamespace" class="mb-2">Seleziona un namespace</div>

    <div class="d-flex justify-content-between align-items-center mb-2">
      <div id="commandButtons" class="d-flex flex-wrap gap-2"></div>
      <div class="dropdown">
        <button class="btn btn-sm btn-outline-light dropdown-toggle" data-bs-toggle="dropdown">
          Comandi Rapidi
        </button>
        <ul class="dropdown-menu dropdown-menu-dark" id="commandMenu"></ul>
      </div>
    </div>

    <div id="overviewRow" class="row g-3 mb-3"></div>

    <div id="monitorPanel" class="mb-3" style="display:none">
      <div class="card p-3">
        <div class="d-flex justify-content-between">
          <h6 class="m-0">üìä Monitoring Tools</h6>
          <button class="btn-close btn-close-white btn-sm" onclick="toggleMonitor()"></button>
        </div>
        <hr class="border-secondary">
        <div class="d-flex flex-wrap gap-2">
          <button class="btn btn-sm btn-outline-info" onclick="openLink('https://grafana.example.com')">Grafana UI</button>
          <button class="btn btn-sm btn-outline-info" onclick="openLink('https://kibana.example.com')">Kibana UI</button>
          <button class="btn btn-sm btn-outline-warning" onclick="runCommand('kubectl get --raw /apis/metrics.k8s.io/v1beta1')">üì° metrics-server health</button>
          <button class="btn btn-sm btn-outline-light" onclick="runCommand('curl -I https://grafana.example.com')">curl Grafana</button>
          <button class="btn btn-sm btn-outline-light" onclick="runCommand('curl -I https://kibana.example.com')">curl Kibana</button>
        </div>
      </div>
    </div>

    <div id="output" class="output-box mb-2">
      <button class="btn btn-sm btn-outline-light copy-btn" onclick="copyOutput()">üìã Copia Output</button>
      Output qui‚Ä¶
    </div>

    <div class="input-group mb-5">
      <input id="customCmd" type="text" class="form-control" value="kubectl get pods -A">
      <button class="btn btn-primary" onclick="runCustomCommand()">Esegui</button>
      <button class="btn btn-success" onclick="saveOutput()">Salva</button>
    </div>
  </div>
</div>

<div id="contextMenu" class="context-menu">
  <button onclick="contextAction('describe')">üîç Describe Pod</button>
  <button onclick="contextAction('logs')">üìú Logs</button>
  <button onclick="contextAction('exec')">üíª Exec (sh)</button>
  <button onclick="contextAction('curl')">üåê Curl check</button>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<script src="main_ui.js"></script>
</body>
</html>
